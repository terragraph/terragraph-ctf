"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[236],{3905:(e,a,t)=>{t.d(a,{Zo:()=>o,kt:()=>c});var n=t(7294);function s(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){s(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function m(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var p=n.createContext({}),i=function(e){var a=n.useContext(p),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},o=function(e){var a=i(e.components);return n.createElement(p.Provider,{value:a},e.children)},N={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},k=n.forwardRef((function(e,a){var t=e.components,s=e.mdxType,r=e.originalType,p=e.parentName,o=m(e,["components","mdxType","originalType","parentName"]),k=i(t),c=s,u=k["".concat(p,".").concat(c)]||k[c]||N[c]||r;return t?n.createElement(u,l(l({ref:a},o),{},{components:t})):n.createElement(u,l({ref:a},o))}));function c(e,a){var t=arguments,s=a&&a.mdxType;if("string"==typeof e||s){var r=t.length,l=new Array(r);l[0]=k;var m={};for(var p in a)hasOwnProperty.call(a,p)&&(m[p]=a[p]);m.originalType=e,m.mdxType="string"==typeof e?e:s,l[1]=m;for(var i=2;i<r;i++)l[i]=t[i];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}k.displayName="MDXCreateElement"},9564:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>p,contentTitle:()=>l,default:()=>N,frontMatter:()=>r,metadata:()=>m,toc:()=>i});var n=t(7462),s=(t(7294),t(3905));const r={},l="Routing Tests",m={unversionedId:"tests/Routing",id:"tests/Routing",title:"Routing Tests",description:"All Tests",source:"@site/../docs/tests/Routing.md",sourceDirName:"tests",slug:"/tests/Routing",permalink:"/terragraph-ctf/tests/Routing",draft:!1,editUrl:"https://github.com/terragraph/terragraph-ctf/edit/main/docs/../docs/tests/Routing.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"RFC 2544 Tests",permalink:"/terragraph-ctf/tests/RFC_2544"},next:{title:"Prefix Allocation (CPA/DPA) Tests",permalink:"/terragraph-ctf/tests/Prefix_Allocation"}},p={},i=[{value:"All Tests",id:"all-tests",level:2},{value:"<code>PUMA_RF_ROU1</code> Link Flap Route Convergence",id:"puma_rf_rou1-link-flap-route-convergence",level:3},{value:"<code>PUMA_RF_ROU2</code> Open/R Flap Route Convergence",id:"puma_rf_rou2-openr-flap-route-convergence",level:3},{value:"<code>PUMA_RF_ROU3</code> Fib Flap Route Convergence (fib_vpp process)",id:"puma_rf_rou3-fib-flap-route-convergence-fib_vpp-process",level:3},{value:"<code>PUMA_RF_ROU4</code> Reboot Route Convergence",id:"puma_rf_rou4-reboot-route-convergence",level:3},{value:"<code>PUMA_RF_ROU5</code> Link Down Reroute Convergence Time",id:"puma_rf_rou5-link-down-reroute-convergence-time",level:3},{value:"<code>PUMA_RF_ROU6</code> MCS-Based Reroute Convergence Time",id:"puma_rf_rou6-mcs-based-reroute-convergence-time",level:3},{value:"<code>PUMA_RF_ROU7</code> Link Flap Backoff",id:"puma_rf_rou7-link-flap-backoff",level:3},{value:"<code>PUMA_RF_ROU8</code> MCS-Based Routing",id:"puma_rf_rou8-mcs-based-routing",level:3}],o={toc:i};function N(e){let{components:a,...t}=e;return(0,s.kt)("wrapper",(0,n.Z)({},o,t,{components:a,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"routing-tests"},"Routing Tests"),(0,s.kt)("h2",{id:"all-tests"},"All Tests"),(0,s.kt)("h3",{id:"puma_rf_rou1-link-flap-route-convergence"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU1")," Link Flap Route Convergence"),(0,s.kt)("p",null,"Description: This test is check if Open/R routes converge after random links are\nrepeatedly flapped in the network."),(0,s.kt)("p",null,"Test Setup: IF Fig-of-8 or largest IF setup available"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Bring up IF setup with external E2E controller with BGP"),(0,s.kt)("li",{parentName:"ul"},"Run iPerf traffic of 300 Mbps on every link"),(0,s.kt)("li",{parentName:"ul"},"Flap a random selection of 30% of links for a duration of 15 mins"),(0,s.kt)("li",{parentName:"ul"},"Measure time took for network to converge"),(0,s.kt)("li",{parentName:"ul"},"Run  10 iterations depending on time & availability")),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Make sure following validations pass:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"All nodes and links in network are online and alive"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze nss validate")," passes"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze fib validate")," passes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all routes to every other nodes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all prefixes"),(0,s.kt)("li",{parentName:"ul"},"Make sure ",(0,s.kt)("inlineCode",{parentName:"li"},"breeze kvstore adj --nodes all")," match on all nodes")))),(0,s.kt)("h3",{id:"puma_rf_rou2-openr-flap-route-convergence"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU2")," Open/R Flap Route Convergence"),(0,s.kt)("p",null,"Description: This test is check if Open/R routes converge after repeatedly\nflapping ",(0,s.kt)("inlineCode",{parentName:"p"},"openr")," process on random nodes in the network."),(0,s.kt)("p",null,"Test Setup: IF Fig-of-8 or largest IF setup available"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Run iPerf traffic of 300 Mbps on every link"),(0,s.kt)("li",{parentName:"ul"},"Flap ",(0,s.kt)("inlineCode",{parentName:"li"},"openr")," process on a random selection of 30% of nodes in the network for\na duration of 15 mins"),(0,s.kt)("li",{parentName:"ul"},"Measure time took for network to converge"),(0,s.kt)("li",{parentName:"ul"},"Run 10 iterations")),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Make sure following validations pass:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"All nodes and links in network are online and alive"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze nss validate")," passes"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze fib validate")," passes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all routes to every other nodes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all prefixes"),(0,s.kt)("li",{parentName:"ul"},"Make sure ",(0,s.kt)("inlineCode",{parentName:"li"},"breeze kvstore adj --nodes all")," match on all nodes")))),(0,s.kt)("h3",{id:"puma_rf_rou3-fib-flap-route-convergence-fib_vpp-process"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU3")," Fib Flap Route Convergence (fib_vpp process)"),(0,s.kt)("p",null,"Description: This test is check if fib routes converge after repeatedly flapping\nfib process on random nodes in the network."),(0,s.kt)("p",null,"Test Setup: IF Fig-of-8 or largest IF setup available"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Run iPerf traffic of 300 Mbps on every link"),(0,s.kt)("li",{parentName:"ul"},"Flap fib process on a random selection of 30% of nodes in the network for a\nduration of 15 mins"),(0,s.kt)("li",{parentName:"ul"},"Measure time took for network to converge"),(0,s.kt)("li",{parentName:"ul"},"Run 10 iterations")),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Make sure following validations pass:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"All nodes and links in network are online and alive"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze nss validate")," passes"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze fib validate")," passes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all routes to every other nodes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all prefixes"),(0,s.kt)("li",{parentName:"ul"},"Make sure ",(0,s.kt)("inlineCode",{parentName:"li"},"breeze kvstore adj --nodes all")," match on all nodes")))),(0,s.kt)("h3",{id:"puma_rf_rou4-reboot-route-convergence"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU4")," Reboot Route Convergence"),(0,s.kt)("p",null,"Description: This test is check if Open/R routes converge after rebooting random\nnodes in the network."),(0,s.kt)("p",null,"Test Setup: IF Fig-of-8 or largest IF setup available"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Reboot a random selection of 20% of the nodes in the network"),(0,s.kt)("li",{parentName:"ul"},"Measure time took for network to converge"),(0,s.kt)("li",{parentName:"ul"},"Run 5-10 iterations")),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Make sure following validations pass:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"All nodes and links in network are online and alive"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze nss validate")," passes"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"breeze fib validate")," passes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all routes to every other nodes"),(0,s.kt)("li",{parentName:"ul"},"Make sure every node has all prefixes"),(0,s.kt)("li",{parentName:"ul"},"Make sure ",(0,s.kt)("inlineCode",{parentName:"li"},"breeze kvstore adj --nodes all")," match on all nodes")))),(0,s.kt)("h3",{id:"puma_rf_rou5-link-down-reroute-convergence-time"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU5")," Link Down Reroute Convergence Time"),(0,s.kt)("p",null,"Description: The purpose of this test is to ensure that on link down, Open/R\nfinds a new route within 240 ms."),(0,s.kt)("p",null,"Test Setup: Any Fig 0 with 4 IF links"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Program all attenuators with 0 dB attenuation."),(0,s.kt)("li",{parentName:"ul"},"Make sure time for attenuator between DN1 \u2192 DN2 is correct otherwise test will\nfail"),(0,s.kt)("li",{parentName:"ul"},"Bring up the Fig 0 using E2E"),(0,s.kt)("li",{parentName:"ul"},"Ping1: Ping all terra links over lo to validate connectivity"),(0,s.kt)("li",{parentName:"ul"},"Parallel block",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Ping3: Ping DN1 \u2192 DN2 for 240 sec with a period of 20ms"),(0,s.kt)("li",{parentName:"ul"},"After 120 sec, set attenuation between DN1-DN2 to 60 dB to cause link to\ngo down")))),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Ping1: Average ping latency for terra links (terra-lo-RTT) < 3.8 ms"),(0,s.kt)("li",{parentName:"ul"},"Ping3: Average ping latency < ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mn",{parentName:"mrow"},"98"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mn",{parentName:"mrow"},"240"),(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mn",{parentName:"mrow"},"98"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mn",{parentName:"mrow"},"3"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,s.kt)("mn",{parentName:"mrow"},"240"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mn",{parentName:"mrow"},"1.1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"(98*\\text{terra-lo-RTT} + (240-98)*3*\\text{terra-lo-RTT})/240*1.1")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord"},"98"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord"},"240"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"98"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"3"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT")),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mord"},"/240"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1.1"))))),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Ping should go over DN1 \u2192 DN2 path for the first ~98 seconds, and the\nlonger 3-IF-hop path afterward"),(0,s.kt)("li",{parentName:"ul"},"terra-lo-RTT is the average RTT of pings sent across the terra links on\nthe lo interface (approximately 3.3 ms)"),(0,s.kt)("li",{parentName:"ul"},"98 seconds because TAS spends ~22 seconds doing initializing steps before\nstarting the actual ping"),(0,s.kt)("li",{parentName:"ul"},"1.1 is to allow for 10% room above the expected average ping latency\nbecause the calculation is approximate"))),(0,s.kt)("li",{parentName:"ul"},"Ping3: Allowed ping max latency < 240ms"),(0,s.kt)("li",{parentName:"ul"},"Ping3: Allowed ping packet loss <= 0.1 % ((Ping packets transmitted - packets\nreceived)*20ms < 240ms)"),(0,s.kt)("li",{parentName:"ul"},"Time difference between attenuation going up and Open/R rerouting finishing <\n240ms for all nodes",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},'Use Open/R log "Processing route add/update for x routes" with x > 0'),(0,s.kt)("li",{parentName:"ul"},"Use the first such log within -1s to 5s of attenuation-up-timestamp (-1s\nis to allow for mismatch in attenuator and node timestamps)")))),(0,s.kt)("h3",{id:"puma_rf_rou6-mcs-based-reroute-convergence-time"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU6")," MCS-Based Reroute Convergence Time"),(0,s.kt)("p",null,"Description:  The purpose of this test is to ensure that on MCS change across\nboundary, Open/R finds a new route within 240 ms."),(0,s.kt)("p",null,"Test Setup: Any Fig 0 with 4 IF links"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Program all attenuators with 0 dB attenuation."),(0,s.kt)("li",{parentName:"ul"},"Make sure time for attenuator between DN1 \u2192 DN2 is correct otherwise test will\nfail"),(0,s.kt)("li",{parentName:"ul"},"Bring up the Fig 0 using E2E (MCS based routing works only if minion is\nrunning on the nodes)"),(0,s.kt)("li",{parentName:"ul"},"Set ",(0,s.kt)("inlineCode",{parentName:"li"},"openrParams.linkMetricConfig.metricMap.MCSX")," to 15 for MCS4, MCS5, MCS6,\nMCS7 and MCS8 for all nodes through E2E"),(0,s.kt)("li",{parentName:"ul"},"Ping1: Ping all terra links over lo to validate connectivity"),(0,s.kt)("li",{parentName:"ul"},"Parallel block",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Ping3: Ping DN1 \u2192 DN2 for 240 sec with a period of 20ms"),(0,s.kt)("li",{parentName:"ul"},"After 120 sec, set attenuation between DN1-DN2 to 30 dB to cause link MCS\nto drop to the range MCS4-MCS8")))),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Ping1: Average ping latency for terra links (terra-lo-RTT) < 3.8 ms"),(0,s.kt)("li",{parentName:"ul"},"Ping3: Average ping latency < ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mn",{parentName:"mrow"},"98"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mn",{parentName:"mrow"},"240"),(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mn",{parentName:"mrow"},"98"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mn",{parentName:"mrow"},"3"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,s.kt)("mn",{parentName:"mrow"},"240"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mn",{parentName:"mrow"},"1.1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"(98*\\text{terra-lo-RTT} +(240-98)*3*\\text{terra-lo-RTT})/240*1.1")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord"},"98"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord"},"240"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"98"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"3"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT")),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mord"},"/240"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1.1"))))),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Ping should go over DN1 \u2192 DN2 path for the first ~98 seconds, and the\nlonger 3-IF-hop path afterward"),(0,s.kt)("li",{parentName:"ul"},"terra-lo-RTT is the average RTT of pings sent across the terra links on\nthe lo interface (approximately 3.3 ms)"),(0,s.kt)("li",{parentName:"ul"},"98 seconds because TAS spends ~22 seconds doing initializing steps before\nstarting the actual ping"),(0,s.kt)("li",{parentName:"ul"},"1.1 is to allow for 10% room above the expected average ping latency\nbecause the calculation is approximate"))),(0,s.kt)("li",{parentName:"ul"},"Ping3: Allowed ping max latency < 240ms"),(0,s.kt)("li",{parentName:"ul"},"Ping3: Allowed ping packet loss <= 0.1 % ((Ping packets transmitted - packets\nreceived)*20ms < 240ms)"),(0,s.kt)("li",{parentName:"ul"},"Time difference between attenuation going up and Open/R rerouting finishing <\n240ms for all nodes",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},'Use Open/R log "Processing route add/update for x routes" with x > 0'),(0,s.kt)("li",{parentName:"ul"},"Use the first such log within -1s to 5s of attenuation-up-timestamp (-1s\nis to allow for mismatch in attenuator and node timestamps)")))),(0,s.kt)("h3",{id:"puma_rf_rou7-link-flap-backoff"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU7")," Link Flap Backoff"),(0,s.kt)("p",null,"Description: The purpose of this test is to ensure that after the link flaps,\nOpen/R debouncing keeps the link down for expected time."),(0,s.kt)("p",null,"Test Setup: Any Fig 0 with 4 IF links"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Program all attenuators with 0 dB attenuation."),(0,s.kt)("li",{parentName:"ul"},"Bring up the Fig 0 (use E2E so links are re-ignited by themselves after\nflapping)"),(0,s.kt)("li",{parentName:"ul"},"Set ",(0,s.kt)("inlineCode",{parentName:"li"},"envParams.OPENR_LINK_FLAP_MAX_BACKOFF_MS")," to 60000 for DN1 and/or DN2\nthrough E2E"),(0,s.kt)("li",{parentName:"ul"},"Ping1: Ping all terra links over lo to validate connectivity"),(0,s.kt)("li",{parentName:"ul"},"Ping2: Ping all USB links over lo to validate connectivity"),(0,s.kt)("li",{parentName:"ul"},"Parallel block",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"On DN1 and/or DN2 (node with high backoff) run command:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"for((i=1; i<=120; i++)); do date; breeze lm links | grep terra0; done > out.txt &")))),(0,s.kt)("li",{parentName:"ul"},"Set attenuation between DN1-DN2 to 60 dB to cause link to go down"),(0,s.kt)("li",{parentName:"ul"},"With delay of 15 seconds bring attenuation back to 0"),(0,s.kt)("li",{parentName:"ul"},"With delay of 30 seconds set attenuation to 60 dB"),(0,s.kt)("li",{parentName:"ul"},"With delay of 45 seconds bring attenuation back to 0"),(0,s.kt)("li",{parentName:"ul"},"With delay of 60 seconds set attenuation to 60 dB"),(0,s.kt)("li",{parentName:"ul"},"With delay of 75 seconds bring attenuation back to 0"),(0,s.kt)("li",{parentName:"ul"},"With delay of 90 seconds set attenuation to 60 dB"),(0,s.kt)("li",{parentName:"ul"},"With delay of 105 seconds bring attenuation back to 0"),(0,s.kt)("li",{parentName:"ul"},"With delay of 110 seconds, start ping DN1 \u2192 DN2 for 30 sec")))),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Ping1: Average ping latency for terra links (terra-lo-RTT) < 3.8 ms"),(0,s.kt)("li",{parentName:"ul"},"Ping3: ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"2"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2*\\text{terra-lo-RTT}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"2"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT"))))))," < Average ping latency < ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"3"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mn",{parentName:"mrow"},"1.05")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"3*\\text{terra-lo-RTT}*1.05")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"3"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1.05"))))),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"3x because ping should go over the longer 3-terra-link path because the\ndirect link is in 60 sec backoff"),(0,s.kt)("li",{parentName:"ul"},"terra-lo-RTT is the average RTT of pings sent across the terra links on\nthe lo interface (approximately 3.3 ms)"),(0,s.kt)("li",{parentName:"ul"},"1.05 is to allow for 5% room above the expected average ping latency\nbecause 3.3 is approximate"))),(0,s.kt)("li",{parentName:"ul"},"In out.txt on DN1 and/or DN2 (node with high backoff), maximum 60sec > 'Hold'\ntime > 55 sec")),(0,s.kt)("h3",{id:"puma_rf_rou8-mcs-based-routing"},(0,s.kt)("inlineCode",{parentName:"h3"},"PUMA_RF_ROU8")," MCS-Based Routing"),(0,s.kt)("p",null,"Description: The purpose of this test is to ensure that routing uses MCS based\ncosts."),(0,s.kt)("p",null,"Test Setup: Any Fig 0 with 4 IF links"),(0,s.kt)("p",null,"Procedure:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Program all attenuators with 0 dB attenuation."),(0,s.kt)("li",{parentName:"ul"},"Bring up the Fig 0 using E2E (MCS based routing works only if minion is\nrunning on the nodes)"),(0,s.kt)("li",{parentName:"ul"},"In node config set ",(0,s.kt)("inlineCode",{parentName:"li"},"openrParams.linkMetricConfig.metricMap.MCSX")," to 15 for\nMCS4, MCS5, MCS6, MCS7 and MCS8 for DN1 and DN2"),(0,s.kt)("li",{parentName:"ul"},"Ping1: Ping all terra links over lo to validate connectivity"),(0,s.kt)("li",{parentName:"ul"},"Set attenuation between DN1-DN2 to 30dB to cause link MCS to drop below MCS8,\nand recored the attenuation-up timestamp"),(0,s.kt)("li",{parentName:"ul"},"Add delay of 5 seconds to let the system stabilize"),(0,s.kt)("li",{parentName:"ul"},"Ping3: Ping DN1 \u2192 DN2 for 240 sec"),(0,s.kt)("li",{parentName:"ul"},"Read ",(0,s.kt)("inlineCode",{parentName:"li"},"/var/log/openr/current")," from DN1 and DN2"),(0,s.kt)("li",{parentName:"ul"},"Remove ",(0,s.kt)("inlineCode",{parentName:"li"},"openrParams.linkMetricConfig.metricMap.MCSX")," overrides to restore\ndefaults on DN1"),(0,s.kt)("li",{parentName:"ul"},"Reset attenuation between DN1-DN2 to 0dB")),(0,s.kt)("p",null,"Pass/Fail Criteria:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Ping1: Average ping latency for terra links < 3.8 ms"),(0,s.kt)("li",{parentName:"ul"},"Ping3: ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"2"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2*\\text{terra-lo-RTT}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"2"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT"))))))," < Average ping latency < ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"3"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mtext",{parentName:"mrow"},"terra-lo-RTT"),(0,s.kt)("mo",{parentName:"mrow"},"\u2217"),(0,s.kt)("mn",{parentName:"mrow"},"1.05")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"3*\\text{terra-lo-RTT}*1.05")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"3"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"terra-lo-RTT")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\u2217"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1.05"))))),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"3x because ping should go over the longer 3-terra-link path"),(0,s.kt)("li",{parentName:"ul"},"terra-lo-RTT is the average RTT of pings sent across the terra links on\nthe lo interface (approximately 3.3 ms)"),(0,s.kt)("li",{parentName:"ul"},"1.05 is to allow for 5% room above the expected average ping latency\nbecause 3.3 is approximate"))),(0,s.kt)("li",{parentName:"ul"},"In Open/R logs, 'Overriding metric for interface terra0 to 15' should exist"),(0,s.kt)("li",{parentName:"ul"},"Timestamp for that log should be within 5 seconds of the attenuation-up\ntimestamp")))}N.isMDXComponent=!0}}]);